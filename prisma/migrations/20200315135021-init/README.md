# Migration `20200315135021-init`

This migration has been generated by Q00 at 3/15/2020, 1:50:21 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "Sex" AS ENUM ('male', 'female');

CREATE TYPE "Provider" AS ENUM ('kakao');

CREATE TABLE "public"."User" (
    "birthdate" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "deletedAt" timestamp(3)   ,
    "id" SERIAL,
    "nickname" text  NOT NULL DEFAULT '',
    "sex" "Sex" NOT NULL DEFAULT 'male',
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "userAccount" integer  NOT NULL ,
    "userPushId" text   ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."UserAccount" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "deletedAt" timestamp(3)   ,
    "id" SERIAL,
    "provider" "Provider" NOT NULL DEFAULT 'kakao',
    "snsId" text  NOT NULL DEFAULT '',
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Nfc" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "deletedAt" timestamp(3)   ,
    "id" SERIAL,
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "value" text  NOT NULL DEFAULT '',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Routine" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "deletedAt" timestamp(3)   ,
    "id" SERIAL,
    "name" text  NOT NULL DEFAULT '',
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "user" integer  NOT NULL ,
    "userNfcRoutine" integer  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Alarm" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "deletedAt" timestamp(3)   ,
    "id" SERIAL,
    "name" text  NOT NULL DEFAULT '',
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Result" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "date" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "deletedAt" timestamp(3)   ,
    "id" SERIAL,
    "resultTimestamp" integer   ,
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "userNfcUser" integer  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Result_timestamp" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "deletedAt" timestamp(3)   ,
    "firstTagging" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "id" SERIAL,
    "lastTagging" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."User_nfc" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "deletedAt" timestamp(3)   ,
    "description" text  NOT NULL DEFAULT '',
    "id" SERIAL,
    "nfc" integer  NOT NULL ,
    "nfcRoutine" integer   ,
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "user" integer  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."User_nfc_routine" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "daysArray" text  NOT NULL DEFAULT '',
    "deletedAt" timestamp(3)   ,
    "endTime" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "fromTime" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "id" SERIAL,
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."User_nfc_alaram" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "deletedAt" timestamp(3)   ,
    "id" SERIAL,
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    PRIMARY KEY ("id")
) 

CREATE UNIQUE INDEX "User.userPushId_userAccount" ON "public"."User"("userPushId","userAccount")

CREATE UNIQUE INDEX "User_userAccount" ON "public"."User"("userAccount")

CREATE UNIQUE INDEX "UserAccount.snsId" ON "public"."UserAccount"("snsId")

CREATE UNIQUE INDEX "Nfc.value" ON "public"."Nfc"("value")

CREATE UNIQUE INDEX "Routine_userNfcRoutine" ON "public"."Routine"("userNfcRoutine")

CREATE UNIQUE INDEX "Result_resultTimestamp" ON "public"."Result"("resultTimestamp")

CREATE UNIQUE INDEX "User_nfc_nfcRoutine" ON "public"."User_nfc"("nfcRoutine")

ALTER TABLE "public"."User" ADD FOREIGN KEY ("userAccount")REFERENCES "public"."UserAccount"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Routine" ADD FOREIGN KEY ("user")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Routine" ADD FOREIGN KEY ("userNfcRoutine")REFERENCES "public"."User_nfc_routine"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Result" ADD FOREIGN KEY ("userNfcUser")REFERENCES "public"."User_nfc_routine"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Result" ADD FOREIGN KEY ("resultTimestamp")REFERENCES "public"."Result_timestamp"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."User_nfc" ADD FOREIGN KEY ("user")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."User_nfc" ADD FOREIGN KEY ("nfc")REFERENCES "public"."Nfc"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."User_nfc" ADD FOREIGN KEY ("nfcRoutine")REFERENCES "public"."User_nfc_routine"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200315135021-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,121 @@
+// This is your Prisma schema file,
+// learn more about it in the docs: https://pris.ly/d/prisma-schema
+
+datasource db {
+  provider = "postgresql"
+  url      = env("DATABASE_URL")
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+enum Sex {
+  male female
+}
+
+enum Provider {
+  kakao
+}
+
+model User {
+  id          Int         @id @default(autoincrement())
+  nickname    String
+  birthdate   DateTime
+  sex         Sex
+  userPushId  String?
+  userAccount UserAccount
+  createdAt   DateTime    @default(now())
+  updatedAt   DateTime    @updatedAt
+  deletedAt   DateTime?
+
+  @@unique([userPushId, userAccount])
+}
+
+model UserAccount {
+  id        Int       @id @default(autoincrement())
+  snsId     String    @unique
+  provider  Provider
+  user      User?
+  createdAt DateTime  @default(now())
+  updatedAt DateTime  @updatedAt
+  deletedAt DateTime?
+}
+
+model Nfc {
+  id        Int        @id @default(autoincrement())
+  value     String     @unique
+  userNfc   User_nfc[]
+  createdAt DateTime   @default(now())
+  updatedAt DateTime   @updatedAt
+  deletedAt DateTime?
+}
+
+model Routine {
+  id             Int              @id @default(autoincrement())
+  name           String
+  user           User
+  userNfcRoutine User_nfc_routine
+  createdAt      DateTime         @default(now())
+  updatedAt      DateTime         @updatedAt
+  deletedAt      DateTime?
+}
+
+model Alarm {
+  id        Int       @id @default(autoincrement())
+  name      String
+  createdAt DateTime  @default(now())
+  updatedAt DateTime  @updatedAt
+  deletedAt DateTime?
+}
+
+model Result {
+  id              Int               @id @default(autoincrement())
+  date            DateTime
+  userNfcUser     User_nfc_routine
+  resultTimestamp Result_timestamp?
+  createdAt       DateTime          @default(now())
+  updatedAt       DateTime          @updatedAt
+  deletedAt       DateTime?
+}
+
+model Result_timestamp {
+  id           Int       @id @default(autoincrement())
+  firstTagging DateTime
+  lastTagging  DateTime
+  result       Result
+  createdAt    DateTime  @default(now())
+  updatedAt    DateTime  @updatedAt
+  deletedAt    DateTime?
+}
+
+model User_nfc {
+  id          Int               @id @default(autoincrement())
+  description String
+  user        User
+  nfc         Nfc
+  nfcRoutine  User_nfc_routine?
+  createdAt   DateTime          @default(now())
+  updatedAt   DateTime          @updatedAt
+  deletedAt   DateTime?
+}
+
+model User_nfc_routine {
+  id        Int       @id @default(autoincrement())
+  daysArray String
+  fromTime  DateTime
+  endTime   DateTime
+  userNfc   User_nfc
+  result    Result[]
+  routine   Routine
+  createdAt DateTime  @default(now())
+  updatedAt DateTime  @updatedAt
+  deletedAt DateTime?
+}
+
+model User_nfc_alaram {
+  id        Int       @id @default(autoincrement())
+  createdAt DateTime  @default(now())
+  updatedAt DateTime  @updatedAt
+  deletedAt DateTime?
+}
```


